■更新履歴
[build 160403 score 1.2]
・長さ0のアカウントが作れてしまう不具合を修正

[build 150830 score 1.2]
・クライアントバージョンチェック処理がおかしかったのを修正
　この修正により日本版最終バージョンではないクライアントは使えなくなる可能性があります
・通常エピソードで2人目以降の参加者が準備ボタンを押せない問題を修正
・エピソード「職員室いっぱいの箱」を仮実装
・アカウントIDにアンダーバー(_)を使用できるようにした

[build 150821a score 1.2]
・キャラ移動時の問題を修正
・アクティブなMobが攻撃しなくなる場合がある不具合を修正
・Mobの索敵処理を修正
・Mobの移動処理を修正
・日本語環境以外でのエラーログが文字化けする問題を修正

[build 150821 score 1.2]
・スレッド間の動作の問題を修正
・管理用パケットでアカウントを削除する際、先にキャラ削除を行うように変更
・サーバ間移動時の問題を修正
・攻撃による向き変更が反映されていなかったのを修正
・エピソードとして「エクストリーム・ボールバトル」を仮実装
　PC同士の殴り合いしかできない上、現時点ではかなりbuggyです
　デフォルトスコアではグラウンド西のゲートから開始できます

[build 150817 score 1.2]
・エピソード「私の三角定規を返して！」を仮実装
　デフォルトスコアでは宵月校舎前のゲートから開始できます
　ランクは未実装のため、時間切れになった場合でもA+になります(現時点での仕様)
・細かい問題の修正

[build 150814 score 1.2]
・エピソードゲートが表示されていなかったのを修正
・「彼と彼女の生徒会」の内容を多少マシに＆マルチプレイ仮対応

[build 150813 score 1.2]
・エピソードに複数人が参加できるようにした(ただし未実装部分が多々あり)
・ルームの作成画面で切断するとロビーにルームが残り続けるバグを修正
・作成中のルームの人数表示が間違っていたバグを修正
・エピソードリザルトで不正なパケットが送られていたバグを修正
・エピソードの途中参加時の処理を修正
・参加人数の上限を超えてエピソードに参加できていたバグを修正
・「箱でいっぱいの廊下」の内容を多少マシに＆マルチプレイ対応化
※テストのため、現状ではサーバ全体で2つまでエピソードルームを作成可能です

[build 150809 score 1.2]
・エピソードゲートの読み込みを有効化
・エピソードとして「箱でいっぱいの廊下」「彼と彼女の生徒会」を仮実装
　どちらも内容は簡略化されており、
　　箱でいっぱいの廊下: 敵の数の減少
　　彼と彼女の生徒会: 敵の数の減少、2階のみ敵出現
　となっています
　また、ドロップアイテムは発生しません
　デフォルトスコアでは宵月校舎前のゲートから開始できます
※！注意！
　ローカル接続のみ正しく処理されるスタンドアローンモードとして動作するため、
　本番環境には導入しないで下さい

[build 150115 score 1.2]
・スコアのgenerator→monsterタグにactive属性を追加
　指定方法などはdefault_score\HF200201\default.xmlを参照
　Mobのアクティブ化はサーバの負荷を著しく高める可能性があるので、部分的に導入して様子を見て下さい

[build 140307 score 1.2]
・データが保存されない場合があるのを修正

[build 140111 score 1.2]
・不正なパケットの送信で他人のキャラでログインできる脆弱性を修正

[build 131222 score 1.2]
・セーブデータをAccount.xmlからAccount.dbへ変更
　※XMLのデータは自動的に引き継がれます
・定期保存処理の高速化
・上記に伴い設定からOtherThreadFileIOを削除

[build 131219 score 1.2]
・通信ライブラリを変更、一部をマルチスレッド化
・マルチスレッド化に伴う排他処理が不完全だった部分を修正
・スコアのNPCスクリプトにelse命令を追加(score.txt参照)

[build 130106 score 1.2]
・ロッカーを実装
・スキルの購入を実装、スコアにbuyskillタグを追加(score.txt参照)
　※現時点でバフ系のスキルは表示に反映されません
・攻撃系スキルを仮実装
・パッシブ系スキルの一部を仮実装(攻撃力、防御力、最大HPが変化するもののみ)

[build 120928 score 1.2]
・ドロップ設定で2個以上を設定しても実際には1個しかドロップしないバグを修正

[build 120828 score 1.2]
・アカウント管理パケット仕様にAI_FIELDの追加、ACCOUNT_LIST構造体の変更(詳細はadmin_dev.txt参照)

[build 120822 score 1.2]
・iniにGeneratorRespawnTime及びFieldSpawnLimitオプションを追加(readme.txt参照)
・iniにOtherThreadFileIOオプションを追加(readme.txt参照)

[build 120516 score 1.2]
・jump命令のラベル名及びcall命令の関数名指定に変数を指定できるようにした
・パケット長が8192バイトを超えた場合に起きるエラーを修正

[build 120116 score 1.2]
・敵撃破時のドロップアイテム配布先に関する処理を修正
・MSG_SYS_ACCOUNT_LIST_ANSに仕様上のバグがあったため、
　パケットにbLast値を追加し、分割するように変更(詳しくはadmin_dev.txt参照)
・上記に伴いAdminToolを更新

[build 111223 score 1.2]
・スコアのNPCスクリプトにgetdatetime命令を追加(score.txt参照)
・iniにDefaultShoutオプションを追加(readme.txt参照)
・定期保存処理を多少軽くしたかも(ただし不具合が出る可能性あり)
・開発環境をDelphi2010からDelphiXE2に移行

[build 110804 score 1.2]
・多少の安定化

[build 110531 score 1.2]
・Mobを倒した際の不具合を修正

[build 110413 score 1.2]
・表示されるエラー情報を増やした

[build 110409 score 1.2]
・save命令の動作を修正
・Mobが2度目以降に生成される時に特定のジェネレータに固まるバグを修正

[build 110408 score 1.2]
・スコアのNPCスクリプトにsave命令を追加(score.txt参照)
・アイテム交換周りのパケット処理を修正
・SaveIntervalが機能していなかったのを修正

[build 110406 score 1.2]
・Mobからの入手経験値を本鯖仕様に変更
・防御補正を暫定導入(単純に被ダメージから防御力/2を減算)
・shoutコマンドを実装(command.txt参照)

[build 110330 score 1.2]
・1つ分の価格で複数のアイテムが買えるバグを修正
・setcharinfoタグのtypeにgradeを指定可能にした

[build 110324 score 1.2]
・ProductList.xmlの読み込み位置をdbからscoreフォルダに移動
・11/03/24のクライアントパッチに対応

[build 110308 score 1.2]
・レアドロップ情報の読み込み処理に関するバグを修正
・Mobの移動処理に関するバグを修正

[build 110228 score 1.2]
・レアドロップの仕様を変更、dropタグを導入し複数のアイテムをドロップ可能にした
　また、ドロップするアイテムの個数を指定可能にした(default_score\HF200201\default.xml参照)

[build 110226 score 1.2]
・AOI更新処理に関するバグを修正

[build 110223 score 1.2]
・nickコマンドに起因するバグを完全に修正
・ヘアドレッサーが新髪型に対応
・ヘアドレッサーを使用した際にTaffが減るようにした
・読み込むマップデータの形式を変更した(db\map.db)
・messageタグのtext属性内に変数を埋め込み可能にした
・その他いくつかのバグ修正など

[build 110214 score 1.2]
・Mobの周囲8マスへの配置処理を多少改善
・経験値テーブルを本鯖仕様にした(データが残っていなかった区間は一応非線形的に補間)
・武器熟練度を仮実装(経験値テーブルは同上)
・レアドロップの仕様を変更、消費アイテム以外に装備アイテムと強化アイテムをドロップ可能にした
　それに伴いrareタグを廃止、beitem、coitem、enitemタグを追加(default_score\HF200201\default.xml参照)
※generatorタグ及びその内部タグは暫定仕様のため、今後も大きく変わる可能性があります
　固定され次第スコアバージョンを上げる予定です
・nickコマンドに起因するバグを修正(したはず)

[build 110211 score 1.2]
・源石脱着パケットの送信範囲が間違っていたのを修正
・speedコマンドの上限を設定(攻撃スピードが2まで、移動スピードが5まで)
・経験値を保存するようにした
・実験的にMobが交戦相手の周囲8マスに配置されるようにした
・Mobとの戦闘中に移動した場合に、Mobが移動せずに攻撃し続けるバグ(の原因の1つ)を修正
・memoコマンドを追加。それに伴いreturnコマンドの仕様を変更(command.txt参照)
・spawnコマンドの仕様を変更
・ログイン直後においてキャラの向きの同期が取れていない場合があるのを修正
・nickコマンドを追加(command.txt参照)

[build 110206 score 1.2]
・攻撃状態にあるMobと一定距離はなれると攻撃を解除するようにした
・アイテムドロップを仮実装
・ジェネレータを仮実装、それに伴いスコアにgeneratorタグなどを追加(default_score\HF200201\default.xml参照)
・フィールド単位によるレアアイテムドロップを実装(ジェネレータ内rareタグ)
・その他細かい修正など

[build 110205 score 1.2]
・敵の移動を実装

[build 110204 score 1.2]
・戦闘不能状態のキャラがいるマップにワープ、あるいは可視範囲に入った場合に
　状態が正しく反映されていなかったのを修正

[build 110203 score 1.2]
・ワープした先のマップに移動中のキャラがいた場合に位置ズレが起きるバグを修正
・mapファイルが必須になった
・エピソード関連の機能を一旦削除(エピソードゲートなど)
・空間分割を実装
※空間分割により具体的にどうなるかというと、あらゆるものの可視範囲が本物と同じになります。
　例えばキャラは一定の距離を離れると消えますし、その状態ではチャットも届かなくなります。
　地味ながら内部的にはかなり大規模な修正を行ったため、
　今までのエピソードゲート周りのコードが流用できなくなり、関連機能を含めてごっそり削ってあります。

　前述のように内部が大きく変わっているため、このバージョンはかなり不安定です。
　キャラが表示されない、動かない、位置ズレが発生する等々の不具合が生じる可能性があります。
　不具合が再現不可能な場合は、不具合が発生した状況をできる限り詳細に報告して下さい。
　（ログイン人数、何番目にログインしたキャラで起きたか、前後にどのような操作をしたかなど）
　また、エラーログに[AOI]で始まる移動ログが残されているので、コピペするか、ファイル毎添付して下さい。
　再現可能な場合はその手順を報告して下さい。
　報告はバグトピまでお願いします。

[build 110131 score 1.2]
・saveフォルダが存在しない場合に起動しないバグを修正
・kujiコマンドの文章をiniでカスタマイズできるように(readme.txt参照)

[build 101121 score 1.2]
・setcharinfo命令のtaff操作に関するバグを修正

[build 101103 score 1.2]
・kujiコマンドが動作しない不具合を修正
・announceコマンドの廃止(aコマンドに統合)

[build 101102 score 1.2]
・各コマンドの使用権限を設定できるように(command.txt参照)

[build 100813 score 1.2]
・エラー関連のメッセージを標準エラーに出力するように
・iniにOutputErrorオプションを追加(readme.txt参照)

[build 100805 score 1.2]
・ifbeitemの動作を修正(対象のアイテムを装備中の場合は結果が偽となる)
・addbeitem命令のパラメータにequipを追加(score.txt参照)
・getcharinfo命令のtypeにbloodを追加(score.txt参照)
・システムイベントにonmakecharを追加(score.txt参照)
・スクリプトにmove命令を追加(score.txt参照)
※システムイベントの更新点はlib\system.xmlの使用サンプルも参照

[build 100804 score 1.2]
・スコアのNPCスクリプトにsetcharinfo命令、getsysinfo命令、setsysinfo命令を追加(score.txt参照)
・スコアのNPCスクリプトにsysmsg命令を追加(score.txt参照)
・システムイベントを実装、システムイベントにonloginを追加(score.txt参照)
・スコアのNPCスクリプトにaddbeitem命令、addcoitem命令、addenitem命令、
　delbeitem命令、delcoitem命令、delenitem命令を追加(score.txt参照)
※NPCスクリプトの更新点はSF002001\npc.xmlの使用サンプルも参照
※システムイベントの更新点はlib\system.xmlの使用サンプルも参照

[build 100802 score 1.1]
・スターアイテムの使用期限周りを実装
　現状ではログイン時と装備解除時に期限チェックが入ります
・スターアイテムの名札台紙を使用可能に

[build 100731 score 1.1]
・結晶作成過程の処理をある程度真面目に実装
・その他軽い調整

[build 100727 score 1.1]
・スターアイテムを仮実装(形だけ)
　ショップからは購入のみ可能です
※スターアイテム導入に伴い装備アイテム全般の内部処理も変わっているので、
　装備アイテム関連の既存機能が正常動作するかチェックをお願いします(装備・購入・強化等々)

[build 100726 score 1.1]
・クイックスロットの内部処理と保存形式を変更
　上記に伴い装備系のみリセットされますので再度登録して下さい

[build 100724 score 1.1]
・CSVファイル読み込みに関するバグを修正

[build 100723 score 1.1]
・装備の内部処理を変更
　上記に伴い装備が一旦解除されるので再度装備して下さい
・源石によるステータス補正を仮実装

[build 100722 score 1.1]
・クイックスロット内でアイテムを移動した場合に重複登録が起きる問題を修正

[build 100721 score 1.1]
・クイックスロット(アイテム)に対応
・callコマンドが正常動作しないのを修正

[build 100715 score 1.1]
・ログイン時必ず昼になるバグを修正
・スコアのNPCスクリプト命令にbgm,seを追加(score.txt参照)

[build 100705 score 1.0]
・大規模なリファクタリング
　内部処理が大幅に変わったのでbuild100626時と同じように既存機能のチェックをお願いします

[build 100704 score 1.0]
・上書き防止のために配布アーカイブのscoreフォルダの名前をdefault_scoreに変更
　(初使用の場合のみscoreにリネームして使う)

[build 100627 score 1.0]
・iniが保存されないバグを修正
・NPCスクリプトの実行コンテキストに起因するバグを修正

[build 100626 score 1.0]
・開発環境をDelphi6からDelphi2010に移行
・accountコマンドを廃止
・spawnコマンドのtypeMotionパラメータを廃止
・mapファイルの読み込みをmapフォルダ内に展開したものからに変更(readme.txt参照)
・上記に伴いiniのMapDataPath廃止
・tagコマンド(名札色変更)を追加(command.txt参照)
・GM権限を持つキャラのチャット文字色を変更

[build 100617]
・スコアに関数を実装(score.txt参照)
・NPCスクリプトにcall命令(関数呼び出し)を追加(score.txt参照)
※関数についてはscore\lib\lyna.xmlの使用サンプルも参照

[build 100616]
・fieldscript→scoreへ名称変更(関連ファイル、フォルダ名も全て変更)
・異常終了時のエラーダイアログ表示を抑制
・異常終了時、エラーをerror.logファイルへ吐くように
・NPCスクリプトにgetcharinfo命令(キャラクター情報取得)を追加(score.txt参照)
※NPCスクリプトの更新点はSF002001\npc.xmlの使用サンプルも参照

[build 100614]
・セッション情報が解放されないバグを修正
・npc->dialogタグにnpcid属性を追加(score.txt参照)

[build 100613]
・特殊番号(通販)を実装(score.txt参照)
・カプセル販売機で購入中の補充をするように

[build 100611]
・NPCダイアログのcutinに変数を指定できるようにした(score.txt参照)
・NPCダイアログ選択肢のtextに変数を埋め込めるようにした(score.txt参照)
・NPCスクリプトのswitch->case命令をif系命令と同じ動作に(score.txt参照)
・NPCダイアログの選択肢を選んだ際に簡単な処理を実行できるようにした(score.txt参照)
※NPCスクリプトの更新点はSF002001\npc.xmlの使用サンプルも参照のこと

[build 100610]
・MSG_SYS_ADMIN_AUTH_REQにenablePushNotificationを追加(admin_dev.txt参照)

[build 100608]
・アカウント管理プロトコルを仮実装(admin_dev.txt参照)
・iniにAdminPort, AuthPasswordオプションを追加(readme.txt参照)
・admintool.exeを添付

[build 100605]
・カプセル販売機(ガチャ)を実装(score.txtおよびSF002006\default.xml参照)
　現在の仕様ではすべて同確率、残量が0になった時点で補充

[build 100604]
・移動してきたキャラにエフェクトを表示するように
・/gotoの座標を省略できるようにした
・/speedのパラメータ省略時の動作を変更
・/kujiのパラメータとして任意のキャラ名を指定できるように
・NPCスクリプトの比較・演算命令のvalue属性に変数が指定できるように(score.txt参照)
・iniにInOutNotifyオプション(登下校通知)を実装(readme.txt参照)
・NPCダイアログの旧仕様("<"と">"を"[["と"]]"で代用)を廃止
・NPCスクリプトのif系命令の仕様を大幅に変更
　今までのスクリプトとは互換性がないので注意(score.txt参照)
・NPCスクリプトの比較や演算の値に変数を指定可能に(score.txt参照)
・NPCダイアログの表示テキスト内に変数を埋め込めるようにした(score.txt参照)
※NPCスクリプトの更新点はSF002001\npc.xmlの使用サンプルも参照のこと

[build 100530]
・付け替えた装備がリログやマップ移動で元に戻るバグを修正(されてるといいな)
・gotoコマンドの移動先をチェックするように
・scoreを差し替え

[build 100528]
・終了時の保存処理タイミングを改善
・iniが無い場合終了時ではなく起動時に作成するようにした
・旧仕様のスコア読み込み処理を削除
・reloadコマンドを実装(command.txt参照)
・getvar, setvar, delvarコマンドを実装(command.txt参照)
・allow, denyコマンドを実装(command.txt参照)

[build 100525]
・XML読み込み全般において、要素が空だった場合に適切なデフォルト値が返せていないバグを修正
・キャラ未作成のアカウントでログインした場合にセッションとアカウントが関連付けられないバグを修正
・NPCスクリプトをテスト導入(score.txt参照)
　とりあえずのサンプルはSF002001\npc.xml
・各ポート番号を指定できるようにした(readme.txt参照)

[build 100523]
・プラカードに正式対応
・上記に伴い/picketコマンドの廃止
・/kujiコマンドの動作を変更(結果が自分のみから同フィールド全員に届くように)
・/chargeコマンドを実装(command.txt参照)
・iniの設定項目にMakeAccountを追加(readme.txt参照)
・上記に関連して/accountコマンドを実装(command.txt参照)
・docにスコアの簡単な説明書(score.txt)を追加
・/kickコマンドを実装(command.txt参照)

[build 100522]
・スコア読み込みパス仕様の変更とファイル分割に対応
　従来はscoreフォルダ下に[fieldid].xmlというファイルを置くことで機能したが、
　今後はscore\[fieldcode]\[任意のファイル名].xmlという配置になる
　ファイルは拡張子がxmlであれば全て読み込む
　※[fieldid]はdbフォルダ内Field.txt内のid、[fieldcode]は同codeのこと
　※一応旧仕様のスコアも読み込むが、いずれ廃止するため今後の利用は非推奨
・上記変更に伴い/whereコマンドの表示を少し変更
・chase, save, returnコマンドを実装(command.txt参照)

[build 100521]
・list, a, an, wis, player, kujiコマンドを実装(command.txt参照)
・プラカードもどきとしてpicketコマンドを実装
　(プラカード使用パケが残ってなかったので苦肉の策…。持ってる人がいたらログ下さい)
　今のところもどきなので内容は保存されない(サーバ再起動で消えます。リログ等では継続)。

[build 100520]
・内部処理を大幅変更した(今までの機能が正常動作するかテストして下さい)

[build 100519]
・必殺技を形だけ使えるようにした(あくまでも見た目のみ)

[build 100518]
・新規時にキャラを作らずにログアウトするとログインできなくなるバグを修正
・表情アクションに対応
・他キャラログアウト時のエフェクトを追加
・callコマンドを実装

[build 100517]
・座ったまま/gotoコマンドを使用した際に動けなくなるバグを修正
・ワールド名の変更を可能に(readme参照)
・昼夜を実装(周期は本鯖仕様…のはず)
・定期保存を実装(readme参照)

[build 100516]
・特殊番号にかけるとNPCに話しかけられなくなるバグを修正(特殊番号自体は未実装のまま)
・スコアのバス移動を実装(副会長が怖くなくなりました)

[build 100515]
・LAN内からの接続に対応(詳しくはreadme参照)
・ローカルテストモードを実装(詳しくはreadme参照)

[build 100509]
・アナウンスコマンド(/announce)を実装

[build 090517]
・マップデータを読み込むようにした(とりあえず今は読み込みだけ)
　iniのMapDataPathにMap.IRDへのパスを記述する
　(C:\Program Files\Yogurting\Models\Terrain\Map\Map.IRDなど)

[build 090515]
・黙々とリファクタリング
・戦闘フィールド上でモンスターを倒すと経験値を入手するように
・戦闘フィールド上で経験値がたまるとレベルアップするように
・移動速度をレベルに応じて変わるようにした

[build 090513]
・黙々とリファクタリング
・内部で暫定ExpTableを生成するように(いずれは外部から読み込む)

[build 090512]
・StatusTable.txtを読んでレベル毎のステータスを計算するようにした

[build 090509]
・scoreにおいて、fieldタグ内のid,name,bgm,idHuntField属性を廃止
　代わりにField.txt内のデータを使用するように

[build 090505]
・黙々とリファクタリング
・複数人が待機部屋へ出たり入ったりしてもそこそこ問題ない感じに
・部屋初期設定でパスワードを使えるようにした

[build 090503]
・黙々とリファクタリング
・ダンスアイテム使用処理周りを微妙に修正
・待機部屋からエピ開始した場合にEscメニューから戻れるようにした(相変わらず1人用)
・デバッグコマンドの接頭辞を@から/に変更
・やるオプーナのAAを微調整
・やるオプーナの▼●▼を茶色っぽく

[build 090501]
・黙々とリファクタリング
・称号の付け替えが暫定的に可能に
　(ただし一部強制称号は外せないので、セーブデータのTitleIDを0にするか、新たにキャラを作り直すこと)
・ログイン中でも内部でログアウト扱いになるバグを修正
・やるオプーナの☆を黄色に
・iniにNoSaveオプションを追加(1にするとエミュ終了時にデータが保存されない)
　主にbuild090428のエピ進入用

[build 090428]
・黙々とリファクタリング
・部屋作ったり出たり(1人用)
　エピフィールドにも入れるけど一方通行なので強制終了しかない
　また、部屋がロビーから削除されない等、未実装部分多数

[build 090427]
・XMLの記述制限を緩和
　<tag attribute="hoge">
　は
　<tag>
　 <attribute>hoge</attribute>
　</tag>
　とも書けるようになった
・上記に伴いCDATAセクションでfontタグ等をそのまま書けるようになった(90.xml辺りを参照)
・やるオプーナのエナジーボンボンが赤くなった
